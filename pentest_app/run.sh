#!/usr/bin/env bash
set -euo pipefail
cd "$(dirname "$0")"

echo "[+] Checking Python venv..."
if [[ ! -d .venv ]]; then
  echo "[+] Creating virtual environment (.venv)"
  python3 -m venv .venv
fi

echo "[+] Activating venv"
source .venv/bin/activate

echo "[+] Upgrading pip & installing requirements"
python -m pip install --upgrade pip setuptools wheel
if [[ -f requirements.txt ]]; then
  pip install -r requirements.txt
fi

if [[ -f .env ]]; then
  echo "[+] Loading environment from .env"
  set -a; source .env; set +a
fi

echo "[+] Starting GUI server (Flask-SocketIO)"
exec python3 pentest_app_gui/app.py
