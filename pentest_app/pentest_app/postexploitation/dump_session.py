# Dump de session réseau (exemple basique)
import os
import subprocess

def dump_sessions(outil="netstat"):
    print(f"Dump des sessions réseau avec l'outil : {outil}")
    if outil == "netstat":
        print("Utilisation de netstat pour afficher les connexions TCP")
        os.system("netstat -tnp")
        print("Dump terminé.")
    elif outil == "suricata":
        print("Analyse des sessions réseau avec Suricata...")
        try:
            result = subprocess.run(["suricata", "-r", "capture.pcap"], capture_output=True, text=True)
            print(result.stdout)
        except Exception as e:
            print(f"Erreur lors de l'exécution de Suricata : {e}")
    elif outil == "metasploit":
        print("Dump de session avec Metasploit (nécessite Metasploit installé et configuré)")
        print("Veuillez lancer le module Metasploit adapté (ex: auxiliary/server/capture/pop3) via msfconsole ou l'API.")
        # Pour une intégration avancée, il faudrait utiliser l'API Metasploit
    else:
        print("Outil non reconnu. Utilisez 'netstat', 'suricata' ou 'metasploit'.")
