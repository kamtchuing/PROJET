import subprocess
from scapy.all import *

def scan_icmp(target, use_nmap=False):
    if use_nmap:
        print(f"Scan ICMP avec nmap sur {target}...")
        try:
            result = subprocess.run(["nmap", "-sn", target], capture_output=True, text=True)
            print(result.stdout)
        except Exception as e:
            print(f"Erreur lors de l'exécution de nmap : {e}")
    else:
        print(f"Scan ICMP avec scapy sur {target}...")
        pkt = IP(dst=target)/ICMP()
        resp = sr1(pkt, timeout=1, verbose=0)
        if resp:
            print(f"{target} est en ligne !")
        else:
            print(f"{target} est hors ligne ou ne répond pas.")
