# Évasion antivirus
import os

def antivirus_evasion(progress_callback=None):
    if progress_callback:
        progress_callback("Test de détection antivirus avec fichier EICAR")
    else:
        print("Test de détection antivirus avec fichier EICAR")
    try:
        with open("eicar_test_file.txt", "w") as f:
            f.write("X5O!P%@AP[4\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*")
        if progress_callback:
            progress_callback("Fichier EICAR généré. Analysez avec votre antivirus.")
        else:
            print("Fichier EICAR généré. Analysez avec votre antivirus.")
    except Exception as e:
        msg = f"Erreur lors de la création du fichier: {e}"
        if progress_callback:
            progress_callback(msg)
        else:
            print(msg)
