<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Pentest App - Reconnaissance</title>
    <style>
        body { background: #181818; color: #00ff00; font-family: 'Courier New', Courier, monospace; }
        .container { max-width: 700px; margin: 40px auto; padding: 30px; background: #222; border-radius: 10px; box-shadow: 0 0 20px #00ff0033; }
        h1 { text-align: center; }
        label, select, input { display: block; margin: 10px 0; }
        .result-box { background: #111; color: #0f0; padding: 15px; border-radius: 8px; margin-top: 20px; white-space: pre-wrap; }
        button { background: #0f0; color: #222; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-weight: bold; }
        button:hover { background: #222; color: #0f0; border: 1px solid #0f0; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Reconnaissance Réseau</h1>
        <form method="post">
            <label for="sous_choix">Type de test :</label>
            <select name="sous_choix" id="sous_choix" required onchange="showFields()">
                <option value="">-- Choisir --</option>
                <option value="scan_port">Scan de port</option>
                <option value="scan_icmp">Scan ICMP</option>
                <option value="service_version">Détection de service/version</option>
            </select>
            <div id="fields"></div>
            <button type="submit">Lancer le test</button>
        </form>
        {% if result %}
        <div class="result-box">
            <h3>Résultat du test :</h3>
            <pre>{{ result }}</pre>
        </div>
        {% endif %}
    </div>
    <script>
        function showFields() {
            var choix = document.getElementById('sous_choix').value;
            var fields = document.getElementById('fields');
            let html = '';
            if (choix === 'scan_port') {
                html += '<label for="target">Cible IP :</label><input name="target" required>';
                html += '<label for="ports">Ports (ex: 22,80,443):</label><input name="ports" required>';
                html += '<label for="outil">Outil :</label><select name="outil"><option value="scapy">Scapy</option><option value="nmap">Nmap</option></select>';
            } else if (choix === 'scan_icmp') {
                html += '<label for="target">Cible IP :</label><input name="target" required>';
                html += '<label for="outil">Outil :</label><select name="outil"><option value="scapy">Scapy</option><option value="nmap">Nmap</option></select>';
            } else if (choix === 'service_version') {
                html += '<label for="target">Cible IP :</label><input name="target" required>';
                html += '<label for="mode">Mode :</label><select name="mode"><option value="all">Lister tous les services</option><option value="port">Cibler un port précis</option></select>';
                html += '<div id="portField"></div>';
                html += '<label for="outil">Outil :</label><select name="outil"><option value="scapy">Scapy</option><option value="nmap">Nmap</option></select>';
            }
            fields.innerHTML = html;
            if (choix === 'service_version') {
                document.querySelector('select[name="mode"]').addEventListener('change', function() {
                    var pf = document.getElementById('portField');
                    if (this.value === 'port') {
                        pf.innerHTML = '<label for="port">Port à cibler :</label><input name="port" type="number" min="1" max="65535" required>';
                    } else {
                        pf.innerHTML = '';
                    }
                });
            }
        }
    </script>
</body>
</html>
